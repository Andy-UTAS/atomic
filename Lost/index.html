
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://qm.utasphys.cloud.edu.au/Lost/">
      
      
      
      <link rel="icon" href="../logo.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.18">
    
    
      
        <title>Placeholder - Quantum Mechanics</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="orange">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#placeholder" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Quantum Mechanics" class="md-header__button md-logo" aria-label="Quantum Mechanics" data-md-component="logo">
      
  <img src="../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Quantum Mechanics
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Placeholder
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Andy-UTAS/qm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Quantum mechanics
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Quantum Mechanics" class="md-nav__button md-logo" aria-label="Quantum Mechanics" data-md-component="logo">
      
  <img src="../logo.png" alt="logo">

    </a>
    Quantum Mechanics
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Andy-UTAS/qm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Quantum mechanics
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../particulars/" class="md-nav__link">
        Course particulars
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          0: Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          0: Introduction
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../00-introduction/0-1-intro/" class="md-nav__link">
        0.1 - Quantum mechanics 101
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          1: Stern-Gerlach Experiments
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          1: Stern-Gerlach Experiments
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01-stern-gerlach/1-1-exp/" class="md-nav__link">
        1.1 - The experiment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01-stern-gerlach/1-2-statevectors/" class="md-nav__link">
        1.2 - State vectors
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../additional/" class="md-nav__link">
        Additional resources
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thermal-expansion" class="md-nav__link">
    Thermal expansion
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#van-der-waals-bond" class="md-nav__link">
    Van der Waals bond
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#looking-ahead-multiple-atoms" class="md-nav__link">
    Looking ahead: multiple atoms
  </a>
  
    <nav class="md-nav" aria-label="Looking ahead: multiple atoms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phonons" class="md-nav__link">
    Phonons
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#electrons" class="md-nav__link">
    Electrons
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#numerical-test" class="md-nav__link">
    Numerical test
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-3-atoms-to-300" class="md-nav__link">
    From 3 atoms to 300
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusions" class="md-nav__link">
    Conclusions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercises" class="md-nav__link">
    Exercises
  </a>
  
    <nav class="md-nav" aria-label="Exercises">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preliminary-provocations" class="md-nav__link">
    Preliminary provocations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-1-linear-triatomic-molecule" class="md-nav__link">
    Exercise 1: Linear triatomic molecule
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-2-the-peierls-transition" class="md-nav__link">
    Exercise 2: the Peierls transition
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tight-binding" class="md-nav__link">
    Tight binding
  </a>
  
    <nav class="md-nav" aria-label="Tight binding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#group-velocity-effective-mass-density-of-states" class="md-nav__link">
    Group velocity, effective mass, density of states
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#density-of-states" class="md-nav__link">
    Density of states
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div><h1 id="placeholder">Placeholder<a class="headerlink" href="#placeholder" title="Permanent link">¶</a></h1>
<div class="admonition failure">
<p class="admonition-title">Empty page</p>
<p>This page is a placeholder: the treasure you seek is in another castle</p>
</div>
<div class="admonition danger">
<p class="admonition-title">Unbaked</p>
<p>The content here is still very much under development. Please come back soon!</p>
</div>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p><img alt="" src=""></p>
<p><intro content></intro></p>
<div class="admonition danger">
<p class="admonition-title">Expected competencies</p>
<p>It is assumed that you have familiarity with the following concepts/techniques:</p>
</div>
<div class="admonition note">
<p class="admonition-title">Text reference</p>
<p>The material covered here is discussed in section(s) <span class="arithmatex">\(\S\)</span> of <a href="https://global.oup.com/academic/product/the-oxford-solid-state-basics-9780199680771?cc=au&amp;lang=en&amp;">The Oxford Solid State Basics</a></p>
</div>
<div class="admonition info">
<p class="admonition-title">Computational content</p>
<p>The Jupyter notebook associated with this section can be accessed by clicking the icon below:
<a class="text-center" href="#" style="margin-left: 45%"><i class="fab fa-python fa-5x"></i></a></p>
</div>
<hr>
<h2 id="thermal-expansion">Thermal expansion<a class="headerlink" href="#thermal-expansion" title="Permanent link">¶</a></h2>
<p>While the quadratic approximation of the interatomic potential is certainly the most important, the anharmonic term <span class="arithmatex">\(\kappa_3(r-a)^3/6\)</span> also has physical significance.
Let us examine its role visually by comparing the harmonic and the third order approximations in the plot below.
Notice that the second-order approximation is symmetric around the minimum while the third-order term is not.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>  <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>  <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>  <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>  <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>  <span class="n">d</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>  <span class="n">U_quadratic</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">r</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>  <span class="n">U_cubic</span> <span class="o">=</span>     <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">r</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">3</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>  <span class="n">r_min</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>  <span class="n">r_max</span> <span class="o">=</span> <span class="mf">2.5</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>  <span class="n">U_min</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>  <span class="n">U_max</span> <span class="o">=</span> <span class="mi">4</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>  <span class="n">E_t_min</span> <span class="o">=</span> <span class="mf">0.4</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>  <span class="n">E_t_max</span> <span class="o">=</span> <span class="mf">3.5</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>  <span class="n">N_values</span> <span class="o">=</span> <span class="mi">20</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>  <span class="n">l_width</span> <span class="o">=</span> <span class="mf">1.5</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>  <span class="n">N_active</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>  <span class="c1"># Create figure</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>  <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>  <span class="k">def</span> <span class="nf">U_c</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>      <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">r</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">3</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>  <span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="n">E_t</span><span class="p">):</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>      <span class="n">right</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">([</span><span class="n">c</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">-</span><span class="n">E_t</span><span class="p">]))</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>      <span class="n">roots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">([</span><span class="n">d</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">-</span><span class="n">E_t</span><span class="p">])</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>      <span class="n">roots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">roots</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isreal</span><span class="p">(</span><span class="n">roots</span><span class="p">)])</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>      <span class="n">roots</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>      <span class="n">left</span> <span class="o">=</span> <span class="n">roots</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>      <span class="k">return</span> <span class="p">[</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">]</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>  <span class="k">def</span> <span class="nf">avg_pos_cubic</span><span class="p">(</span><span class="n">E_t</span><span class="p">):</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>      <span class="n">Z</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simps</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span> <span class="n">U_cubic</span> <span class="o">/</span> <span class="n">E_t</span><span class="p">),</span> <span class="n">r</span><span class="p">)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>      <span class="n">r_avg</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simps</span><span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span> <span class="n">U_cubic</span> <span class="o">/</span> <span class="n">E_t</span><span class="p">),</span> <span class="n">r</span><span class="p">)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>      <span class="n">x</span> <span class="o">=</span> <span class="n">r_avg</span> <span class="o">/</span> <span class="n">Z</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>      <span class="k">return</span> <span class="n">x</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>  <span class="c1"># Add traces, one for each slider step</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>  <span class="k">for</span> <span class="n">E_t</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">E_t_min</span><span class="p">,</span> <span class="n">E_t_max</span><span class="p">,</span> <span class="n">N_values</span><span class="p">):</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>      <span class="n">avg</span> <span class="o">=</span> <span class="n">avg_pos_cubic</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>      <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>          <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>              <span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a>              <span class="n">x</span> <span class="o">=</span> <span class="n">r</span><span class="p">,</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>              <span class="n">y</span> <span class="o">=</span> <span class="n">U_quadratic</span><span class="p">,</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>              <span class="n">mode</span> <span class="o">=</span> <span class="s1">'lines'</span><span class="p">,</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>              <span class="n">line_color</span> <span class="o">=</span> <span class="s1">'blue'</span><span class="p">,</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>              <span class="n">name</span> <span class="o">=</span> <span class="s2">"Quadratic potential"</span><span class="p">,</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>          <span class="p">))</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>      <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>          <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>              <span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>              <span class="n">x</span> <span class="o">=</span> <span class="n">r</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>              <span class="n">y</span> <span class="o">=</span> <span class="n">U_cubic</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>              <span class="n">mode</span> <span class="o">=</span> <span class="s1">'lines'</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>              <span class="n">line_color</span> <span class="o">=</span> <span class="s1">'red'</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>              <span class="n">name</span> <span class="o">=</span> <span class="s2">"Cubic potential"</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a>          <span class="p">))</span>
<a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a>      <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
<a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a>          <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
<a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a>              <span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a>              <span class="n">x</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="n">E_t</span><span class="p">),</span>
<a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a>              <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">E_t</span><span class="p">,</span> <span class="n">E_t</span><span class="p">],</span>
<a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a>              <span class="n">mode</span> <span class="o">=</span> <span class="s1">'lines'</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a>              <span class="n">line_color</span> <span class="o">=</span> <span class="s1">'black'</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a>              <span class="n">name</span> <span class="o">=</span>  <span class="sa">r</span><span class="s1">'Thermal energy level'</span>
<a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a>          <span class="p">))</span>
<a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a>      <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
<a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a>          <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
<a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a>              <span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a>              <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a>              <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">E_t</span><span class="p">],</span>
<a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a>              <span class="n">mode</span> <span class="o">=</span> <span class="s1">'lines'</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a>              <span class="n">line_color</span> <span class="o">=</span> <span class="s1">'blue'</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a>              <span class="n">line_dash</span> <span class="o">=</span> <span class="s1">'dot'</span><span class="p">,</span>
<a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a>              <span class="n">name</span> <span class="o">=</span>  <span class="sa">r</span><span class="s1">'$\langle r \rangle$ for the quadratic potential'</span>
<a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a>          <span class="p">))</span>
<a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a>      <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a>          <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
<a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a>              <span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a>              <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">avg</span><span class="p">,</span> <span class="n">avg</span><span class="p">],</span>
<a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a>              <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">U_c</span><span class="p">(</span><span class="n">avg</span><span class="p">),</span> <span class="n">E_t</span><span class="p">],</span>
<a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a>              <span class="n">mode</span> <span class="o">=</span> <span class="s1">'lines'</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a>              <span class="n">line_color</span> <span class="o">=</span> <span class="s1">'red'</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a>              <span class="n">line_dash</span> <span class="o">=</span> <span class="s1">'dot'</span><span class="p">,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a>              <span class="n">name</span> <span class="o">=</span>  <span class="sa">r</span><span class="s1">'$\langle r \rangle$ for the cubic potential'</span>
<a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a>          <span class="p">))</span>
<a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a>  <span class="c1"># Initial starting image</span>
<a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a>  <span class="n">N_trace</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">/</span><span class="n">N_values</span><span class="p">)</span> <span class="c1"># Number of traces added per step</span>
<a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a>  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_trace</span><span class="p">):</span>
<a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a>      <span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">N_active</span><span class="o">*</span><span class="n">N_trace</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a>  <span class="c1"># Creation of the aditional images</span>
<a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a>  <span class="n">steps</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">/</span><span class="n">N_trace</span><span class="p">)):</span>
<a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a>      <span class="n">step</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a>          <span class="n">method</span> <span class="o">=</span> <span class="s2">"restyle"</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a>          <span class="n">args</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">"visible"</span><span class="p">:</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">)}],</span>
<a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a>          <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a>      <span class="p">)</span>
<a id="__codelineno-0-108" name="__codelineno-0-108" href="#__codelineno-0-108"></a>      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_trace</span><span class="p">):</span>
<a id="__codelineno-0-109" name="__codelineno-0-109" href="#__codelineno-0-109"></a>          <span class="n">step</span><span class="p">[</span><span class="s2">"args"</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">"visible"</span><span class="p">][</span><span class="n">N_trace</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Toggle i'th trace to "visible"</span>
<a id="__codelineno-0-110" name="__codelineno-0-110" href="#__codelineno-0-110"></a>      <span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111" href="#__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112" href="#__codelineno-0-112"></a>  <span class="c1"># Creating the slider</span>
<a id="__codelineno-0-113" name="__codelineno-0-113" href="#__codelineno-0-113"></a>  <span class="n">sliders</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-114" name="__codelineno-0-114" href="#__codelineno-0-114"></a>      <span class="n">tickcolor</span> <span class="o">=</span> <span class="s1">'White'</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115" href="#__codelineno-0-115"></a>      <span class="n">font_color</span> <span class="o">=</span> <span class="s1">'White'</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116" href="#__codelineno-0-116"></a>      <span class="n">currentvalue_font_color</span> <span class="o">=</span> <span class="s1">'Black'</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117" href="#__codelineno-0-117"></a>      <span class="n">active</span> <span class="o">=</span> <span class="n">N_active</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118" href="#__codelineno-0-118"></a>      <span class="n">name</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'Thermal Energy'</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119" href="#__codelineno-0-119"></a>      <span class="n">font_size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120" href="#__codelineno-0-120"></a>      <span class="n">currentvalue</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"prefix"</span><span class="p">:</span> <span class="sa">r</span><span class="s1">'Thermal Energy k_B T: '</span><span class="p">},</span>
<a id="__codelineno-0-121" name="__codelineno-0-121" href="#__codelineno-0-121"></a>      <span class="n">pad</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"t"</span><span class="p">:</span> <span class="mi">50</span><span class="p">},</span>
<a id="__codelineno-0-122" name="__codelineno-0-122" href="#__codelineno-0-122"></a>      <span class="n">steps</span> <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123" href="#__codelineno-0-123"></a>  <span class="p">)]</span>
<a id="__codelineno-0-124" name="__codelineno-0-124" href="#__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125" href="#__codelineno-0-125"></a>  <span class="c1"># Updating the images for each step</span>
<a id="__codelineno-0-126" name="__codelineno-0-126" href="#__codelineno-0-126"></a>  <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
<a id="__codelineno-0-127" name="__codelineno-0-127" href="#__codelineno-0-127"></a>      <span class="n">sliders</span> <span class="o">=</span> <span class="n">sliders</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128" href="#__codelineno-0-128"></a>      <span class="n">showlegend</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129" href="#__codelineno-0-129"></a>      <span class="n">plot_bgcolor</span> <span class="o">=</span> <span class="s1">'rgb(254, 254, 254)'</span><span class="p">,</span>
<a id="__codelineno-0-130" name="__codelineno-0-130" href="#__codelineno-0-130"></a>      <span class="n">width</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131" href="#__codelineno-0-131"></a>      <span class="n">height</span> <span class="o">=</span> <span class="mi">580</span><span class="p">,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132" href="#__codelineno-0-132"></a>      <span class="n">xaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-133" name="__codelineno-0-133" href="#__codelineno-0-133"></a>          <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="n">r_min</span><span class="p">,</span> <span class="n">r_max</span><span class="p">],</span>
<a id="__codelineno-0-134" name="__codelineno-0-134" href="#__codelineno-0-134"></a>          <span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-135" name="__codelineno-0-135" href="#__codelineno-0-135"></a>          <span class="n">showticklabels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136" href="#__codelineno-0-136"></a>          <span class="n">showline</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137" href="#__codelineno-0-137"></a>          <span class="n">linewidth</span> <span class="o">=</span> <span class="n">l_width</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138" href="#__codelineno-0-138"></a>          <span class="n">linecolor</span> <span class="o">=</span> <span class="s1">'black'</span><span class="p">,</span>
<a id="__codelineno-0-139" name="__codelineno-0-139" href="#__codelineno-0-139"></a>          <span class="n">gridcolor</span> <span class="o">=</span> <span class="s1">'white'</span><span class="p">,</span>
<a id="__codelineno-0-140" name="__codelineno-0-140" href="#__codelineno-0-140"></a>          <span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">)),</span>
<a id="__codelineno-0-141" name="__codelineno-0-141" href="#__codelineno-0-141"></a>      <span class="n">yaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-142" name="__codelineno-0-142" href="#__codelineno-0-142"></a>          <span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="n">U_min</span><span class="p">,</span> <span class="n">U_max</span><span class="p">],</span>
<a id="__codelineno-0-143" name="__codelineno-0-143" href="#__codelineno-0-143"></a>          <span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144" href="#__codelineno-0-144"></a>          <span class="n">showticklabels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145" href="#__codelineno-0-145"></a>          <span class="n">showline</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146" href="#__codelineno-0-146"></a>          <span class="n">linewidth</span> <span class="o">=</span> <span class="n">l_width</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147" href="#__codelineno-0-147"></a>          <span class="n">linecolor</span> <span class="o">=</span> <span class="s1">'black'</span><span class="p">,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148" href="#__codelineno-0-148"></a>          <span class="n">gridcolor</span> <span class="o">=</span> <span class="s1">'white'</span><span class="p">,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149" href="#__codelineno-0-149"></a>          <span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">)),</span>
<a id="__codelineno-0-150" name="__codelineno-0-150" href="#__codelineno-0-150"></a>      <span class="n">title</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'text'</span><span class="p">:</span> <span class="sa">r</span><span class="s1">'Thermal expansion of cubic potential'</span><span class="p">,</span>
<a id="__codelineno-0-151" name="__codelineno-0-151" href="#__codelineno-0-151"></a>          <span class="s1">'y'</span><span class="p">:</span><span class="mf">0.9</span><span class="p">,</span>
<a id="__codelineno-0-152" name="__codelineno-0-152" href="#__codelineno-0-152"></a>          <span class="s1">'x'</span><span class="p">:</span><span class="mf">0.45</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153" href="#__codelineno-0-153"></a>          <span class="s1">'xanchor'</span><span class="p">:</span> <span class="s1">'center'</span><span class="p">,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154" href="#__codelineno-0-154"></a>          <span class="s1">'yanchor'</span><span class="p">:</span> <span class="s1">'top'</span><span class="p">},</span>
<a id="__codelineno-0-155" name="__codelineno-0-155" href="#__codelineno-0-155"></a>      <span class="n">xaxis_title</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'$r$'</span><span class="p">,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156" href="#__codelineno-0-156"></a>      <span class="n">yaxis_title</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'$U [k_b T]$'</span><span class="p">,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157" href="#__codelineno-0-157"></a>  <span class="p">)</span>  
<a id="__codelineno-0-158" name="__codelineno-0-158" href="#__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159" href="#__codelineno-0-159"></a>  <span class="c1"># Edit slider labels and adding text next to the horizontal bar indicating T_E</span>
<a id="__codelineno-0-160" name="__codelineno-0-160" href="#__codelineno-0-160"></a>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_values</span><span class="p">):</span>
<a id="__codelineno-0-161" name="__codelineno-0-161" href="#__codelineno-0-161"></a>      <span class="n">fig</span><span class="p">[</span><span class="s1">'layout'</span><span class="p">][</span><span class="s1">'sliders'</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">'steps'</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="s1">'label'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">' </span><span class="si">%.1f</span><span class="s1"> '</span> <span class="o">%</span> <span class="p">((</span><span class="n">E_t_max</span><span class="o">-</span><span class="n">E_t_min</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="p">(</span><span class="n">N_values</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">E_t_min</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162" href="#__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163" href="#__codelineno-0-163"></a>  <span class="c1"># Showing the figure</span>
<a id="__codelineno-0-164" name="__codelineno-0-164" href="#__codelineno-0-164"></a>  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165" href="#__codelineno-0-165"></a>  <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p>The asymmetry due to nonzero <span class="arithmatex">\(\kappa_3\)</span> slows the growth of the potential when the interatomic distance increases.
On the other hand, when the interatomic distance decreases, the asymmetry accelerates the growth of the potential.
Therefore, stretching the material is more energetically favorable than contracting it.
As a result, thermal excitations increase the interatomic distance.
This gives us a simple model of <em>thermal expansion</em>.</p>
<h2 id="van-der-waals-bond">Van der Waals bond<a class="headerlink" href="#van-der-waals-bond" title="Permanent link">¶</a></h2>
<p>While we focus on the mechanisms of covalent bonding, let us also review another bond type.</p>
<p>A <em>Van der Waals bond</em> originates from an attraction between the dipole moments of two atoms.
Suppose we have two atoms separated by an interatomic distance <span class="arithmatex">\(r\)</span>.
If one atom has a dipole moment <span class="arithmatex">\(\mathbf{p_1}\)</span>, it creates an electric field</p>
<div class="arithmatex">\[ \mathbf{E} = \frac{\mathbf{p_1}}{4\pi \varepsilon_0 r^3} \]</div>
<p>at the position of the other atom.
The other atom then develops a dipole moment <span class="arithmatex">\(\mathbf{p_2} = \chi \mathbf{E}\)</span> with <span class="arithmatex">\(\chi\)</span> the <em>polarizability</em> of the atom.</p>
<p>The potential energy between between the two dipoles is
<script type="math/tex; mode=display">
\begin{align}
U(r) &= \frac{-|\mathbf{p_1}||\mathbf{p_2}|}{4\pi\varepsilon_0 r^3}\\
&= \frac{-|\mathbf{p_1}| \chi \mathbf{E}}{4\pi\varepsilon_0 r^3}\\
&= \frac{-|\mathbf{p_1}|^2 \chi}{(4\pi\varepsilon_0 r^3)^2}\\
&\propto \frac{1}{r^6}.
\end{align}
</script>
</p>
<p>The dipole attraction is much weaker than the covalent bonds but drops slower with increasing distance.</p>
<details class="question">
<summary>How does the strength of a covalent bond scale with distance?</summary>
<p>The strength of the bond is determined by the interatomic hopping integral <span class="arithmatex">\(-t = \langle 1 | H | 2 \rangle\)</span>. Since the wavefunction of a bound electron typically decays exponentially, so does the overlap integral.</p>
</details>
<p>Although the Van der Waals force is weak, it is the only force when there are no chemically active electrons or when the atoms are too far apart to form covalent bonds.
Therefore, there are materials where Van der Waals interactions are the dominant interactions.
An example of such a material is graphite.
The Van der Waals bonds in graphite hold layers of covalently bonded carbon atoms together:</p>
<p><img alt="Graphite atomic layers" src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5f/Graphite-layers-side-3D-balls.png/320px-Graphite-layers-side-3D-balls.png"><br>
(image source: <a href="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5f/Graphite-layers-side-3D-balls.png/320px-Graphite-layers-side-3D-balls.png">Wikipedia</a>)</p>
<h2 id="looking-ahead-multiple-atoms">Looking ahead: multiple atoms<a class="headerlink" href="#looking-ahead-multiple-atoms" title="Permanent link">¶</a></h2>
<p>So far we have only considered the interatomic interactions between diatomic systems.
However, our aim is to understand electrons and phonons in solids containing <span class="arithmatex">\(N\to\infty\)</span> atoms.</p>
<p>Let us see what happens when we consider more than two atoms.</p>
<h3 id="phonons">Phonons<a class="headerlink" href="#phonons" title="Permanent link">¶</a></h3>
<p>In order to understand phonons better, we need to understand how a vibrational motion in a solid arises.
To that end, we model an array of atoms that are connected by springs with a spring constant <span class="arithmatex">\(\kappa\)</span>.
Our plan:</p>
<ul>
<li>Consider only a <em>harmonic potential</em> acting between the atoms (<span class="arithmatex">\(\kappa\)</span> is constant)</li>
<li>Write down equations of motion</li>
<li>Compute normal modes</li>
</ul>
<!-- ![](figures/phonons2.svg) -->
<p>For simplicity we consider 1D motion, and let us start with a chain of 3 atoms:
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Defining constants</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">y_max</span> <span class="o">=</span> <span class="mi">6</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">max_m</span> <span class="o">=</span> <span class="mi">3</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="c1"># Off set for the new masses</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="n">deviation_arr</span> <span class="o">=</span> <span class="p">[</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.5</span><span class="p">]</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="k">def</span> <span class="nf">plot_spring</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">annotation</span>  <span class="o">=</span> <span class="sa">r</span><span class="s1">'$\kappa$'</span><span class="p">):</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    <span class="n">L</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>    <span class="n">width</span><span class="p">,</span> <span class="n">nturns</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>    <span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>    <span class="n">pad</span> <span class="o">=</span> <span class="mi">200</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>    <span class="c1"># Make the spring, unit scale (0 to 1)</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>    <span class="n">x_spring</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="c1"># distance along the spring</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>    <span class="n">y_spring</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>    <span class="n">y_spring</span><span class="p">[</span><span class="n">pad</span><span class="p">:</span><span class="o">-</span><span class="n">pad</span><span class="p">]</span> <span class="o">=</span> <span class="n">width</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">nturns</span> <span class="o">*</span> <span class="n">x_spring</span><span class="p">[</span><span class="n">pad</span><span class="p">:</span><span class="o">-</span><span class="n">pad</span><span class="p">]</span><span class="o">/</span><span class="n">L</span><span class="p">)</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>    <span class="n">x_plot</span><span class="p">,</span> <span class="n">y_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">x_spring</span><span class="p">,</span> <span class="n">y_spring</span><span class="p">))</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>    <span class="c1"># And offset it</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>    <span class="n">x_plot</span> <span class="o">+=</span> <span class="n">x1</span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>    <span class="n">y_plot</span> <span class="o">+=</span> <span class="n">y</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">y_plot</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'k'</span><span class="p">)</span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">annotation</span><span class="p">,</span> <span class="p">((</span><span class="n">x2</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">40</span><span class="p">)</span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="k">def</span> <span class="nf">plot_mass</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">annotation</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'$m$'</span><span class="p">):</span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>    <span class="n">mass</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="mf">.5</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">'k'</span><span class="p">)</span>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">mass</span><span class="p">)</span>
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">annotation</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">.5</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a>
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a>
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a><span class="k">def</span> <span class="nf">make_plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">deviation_arr</span><span class="p">,</span> <span class="n">max_masses</span> <span class="o">=</span> <span class="mi">3</span><span class="p">):</span>   
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a>    <span class="c1"># plotting initial masses</span>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a>    <span class="n">plot_mass</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a>    <span class="n">plot_mass</span><span class="p">(</span><span class="mi">0</span><span class="o">+</span><span class="n">deviation_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">u</span><span class="p">,</span> <span class="n">annotation</span> <span class="o">=</span> <span class="s1">''</span><span class="p">)</span>
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a>
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a>    <span class="c1"># Plot initial dotted lines</span>
<a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">u</span><span class="o">-</span><span class="mf">2.5</span><span class="p">),</span> <span class="s1">'k--'</span><span class="p">)</span>
<a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">deviation_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">deviation_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">u</span><span class="o">-</span><span class="mf">2.5</span><span class="p">),</span> <span class="s1">'k--'</span><span class="p">)</span>
<a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a><span class="c1">#     pyplot.plot((0, deviation_arr[0]), (u-2.5, u-2.5), 'k--')</span>
<a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">u</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">deviation_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">.25</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
<a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a>
<a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a>    <span class="c1"># Annotate the deviations</span>
<a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a>    <span class="n">annot_arr</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">'$u_1$'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$u_2$'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$u_3$'</span><span class="p">]</span>
<a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a>    <span class="n">off_set</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">annot_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">deviation_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">off_set</span><span class="o">+</span><span class="mf">.4</span><span class="p">,</span> <span class="n">u</span><span class="o">-</span><span class="mi">3</span><span class="o">+</span><span class="n">off_set</span><span class="p">),</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a>
<a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a>    <span class="c1"># Annotate large arrow containing the interatomic distance</span>
<a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="n">u</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$a$'</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">u</span><span class="o">/</span><span class="mi">3</span><span class="o">+</span><span class="n">off_set</span><span class="p">),</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a>
<a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a>    <span class="c1"># Plotting other masses and springs</span>
<a id="__codelineno-1-56" name="__codelineno-1-56" href="#__codelineno-1-56"></a>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_masses</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-1-57" name="__codelineno-1-57" href="#__codelineno-1-57"></a>        <span class="c1"># Equilibrium plot</span>
<a id="__codelineno-1-58" name="__codelineno-1-58" href="#__codelineno-1-58"></a>        <span class="n">plot_spring</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">j</span><span class="p">,</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-1-59" name="__codelineno-1-59" href="#__codelineno-1-59"></a>        <span class="n">plot_mass</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-1-60" name="__codelineno-1-60" href="#__codelineno-1-60"></a>
<a id="__codelineno-1-61" name="__codelineno-1-61" href="#__codelineno-1-61"></a>        <span class="c1"># Plot containing deviations from it's equilibrium</span>
<a id="__codelineno-1-62" name="__codelineno-1-62" href="#__codelineno-1-62"></a>        <span class="n">plot_spring</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="n">deviation_arr</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">deviation_arr</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">u</span><span class="p">,</span> <span class="n">annotation</span> <span class="o">=</span> <span class="s1">''</span><span class="p">)</span>
<a id="__codelineno-1-63" name="__codelineno-1-63" href="#__codelineno-1-63"></a>        <span class="n">plot_mass</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">deviation_arr</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">u</span><span class="p">,</span> <span class="n">annotation</span> <span class="o">=</span> <span class="s1">''</span><span class="p">)</span>
<a id="__codelineno-1-64" name="__codelineno-1-64" href="#__codelineno-1-64"></a>
<a id="__codelineno-1-65" name="__codelineno-1-65" href="#__codelineno-1-65"></a>        <span class="c1"># Plot dotted lines</span>
<a id="__codelineno-1-66" name="__codelineno-1-66" href="#__codelineno-1-66"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">u</span><span class="o">-</span><span class="mf">2.5</span><span class="p">),</span> <span class="s1">'k--'</span><span class="p">)</span>
<a id="__codelineno-1-67" name="__codelineno-1-67" href="#__codelineno-1-67"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">deviation_arr</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">deviation_arr</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">u</span><span class="o">-</span><span class="mf">2.5</span><span class="p">),</span> <span class="s1">'k--'</span><span class="p">)</span>
<a id="__codelineno-1-68" name="__codelineno-1-68" href="#__codelineno-1-68"></a><span class="c1">#         pyplot.plot((10*(j+1), 10*(j+1)+deviation_arr[j+1]), (u-2.5, u-2.5), 'k--')</span>
<a id="__codelineno-1-69" name="__codelineno-1-69" href="#__codelineno-1-69"></a>        <span class="n">pyplot</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">u</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="p">(</span><span class="n">deviation_arr</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">.5</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">.25</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
<a id="__codelineno-1-70" name="__codelineno-1-70" href="#__codelineno-1-70"></a>
<a id="__codelineno-1-71" name="__codelineno-1-71" href="#__codelineno-1-71"></a>        <span class="c1"># Annotations</span>
<a id="__codelineno-1-72" name="__codelineno-1-72" href="#__codelineno-1-72"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">annot_arr</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">deviation_arr</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">off_set</span><span class="o">+</span><span class="mf">.4</span><span class="p">,</span> <span class="n">u</span><span class="o">-</span><span class="mi">3</span><span class="o">+</span><span class="n">off_set</span><span class="p">),</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<a id="__codelineno-1-73" name="__codelineno-1-73" href="#__codelineno-1-73"></a>
<a id="__codelineno-1-74" name="__codelineno-1-74" href="#__codelineno-1-74"></a><span class="c1"># Initializing figure</span>
<a id="__codelineno-1-75" name="__codelineno-1-75" href="#__codelineno-1-75"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<a id="__codelineno-1-76" name="__codelineno-1-76" href="#__codelineno-1-76"></a><span class="n">pyplot</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>
<a id="__codelineno-1-77" name="__codelineno-1-77" href="#__codelineno-1-77"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">max_m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-1-78" name="__codelineno-1-78" href="#__codelineno-1-78"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="n">y_max</span><span class="o">-</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">y_max</span><span class="o">-</span><span class="mf">2.5</span><span class="p">))</span>
<a id="__codelineno-1-79" name="__codelineno-1-79" href="#__codelineno-1-79"></a>
<a id="__codelineno-1-80" name="__codelineno-1-80" href="#__codelineno-1-80"></a><span class="c1"># Plottig system</span>
<a id="__codelineno-1-81" name="__codelineno-1-81" href="#__codelineno-1-81"></a><span class="n">make_plot</span><span class="p">(</span><span class="o">-</span><span class="n">y_max</span><span class="p">,</span> <span class="n">deviation_arr</span><span class="p">,</span> <span class="n">max_m</span><span class="p">);</span>
<a id="__codelineno-1-82" name="__codelineno-1-82" href="#__codelineno-1-82"></a><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p>Let us denote the deviation of atom <span class="arithmatex">\(i\)</span> from its equilibrium position by <span class="arithmatex">\(u_i\)</span>.
Newton's equations of motion for this system are then given by</p>
<div class="arithmatex">\[
\begin{aligned}
m \ddot{u}_1 &amp;= - \kappa (u_1 - u_2) \\
m \ddot{u}_2 &amp;= - \kappa (u_2 - u_1) - \kappa (u_2 - u_3) \\
m \ddot{u}_3 &amp;= - \kappa (u_3 - u_2).
\end{aligned},
\]</div>
<p>We write this system of equations in matrix form</p>
<div class="arithmatex">\[
m \ddot{\mathbf{u}} = -\kappa
\begin{pmatrix}
1 &amp; -1 &amp; 0\\
-1 &amp; 2 &amp; -1\\
0 &amp; -1 &amp; 1
\end{pmatrix}\mathbf{u}
\]</div>
<p>We are interested in phonons, patterns of motion that are periodic and have a fixed frequency <span class="arithmatex">\(\omega\)</span>.
Hence we guess that the motion of the atoms is</p>
<div class="arithmatex">\[
\mathbf{u}(t) = \mathbf{u}_0 e^{i\omega t}.
\]</div>
<p>We substitute our guess into the equations of motion to yield an eigenvalue problem:</p>
<div class="arithmatex">\[
\omega^2 \mathbf{u}_0 = \frac{\kappa}{m}
\begin{pmatrix}
1 &amp; -1 &amp; 0\\
-1 &amp; 2 &amp; -1\\
0 &amp; -1 &amp; 1
\end{pmatrix}\mathbf{u}_0.
\]</div>
<p>The solutions to the eigenvalue problem are phonon modes.</p>
<h3 id="electrons">Electrons<a class="headerlink" href="#electrons" title="Permanent link">¶</a></h3>
<p>We just looked at how a chain of atoms moves.
Let us now look at how the electrons of those atoms behave.
To that end, we consider a 3 atom chain without any motion.</p>
<!--
Figure having 3 atoms with a hopping -t
-->
<p>In order to understand how electrons behave, we use the <abbr title="Linear Combination of Atomic Orbitals">LCAO</abbr> model.
The <abbr title="Linear Combination of Atomic Orbitals">LCAO</abbr> model generalizes in a very simple way.
Let us consider the wavefunction:
<script type="math/tex; mode=display">
\vert \psi\rangle = \varphi_1 |1\rangle + \varphi_2 |2\rangle + \varphi_3 |3\rangle.
</script>
Because the three atoms are identical, the onsite energy is the same on all atoms <span class="arithmatex">\(\langle 1|H|1 \rangle = \langle2|H|2 \rangle = \langle3|H|3 \rangle = E_0\)</span>.
Furthermore, we assume hopping only between the nearest neighbors and assume that it is real valued: <span class="arithmatex">\(\langle1|H|2\rangle = \langle2|H|3\rangle = -t\)</span>.
We also assume that the orbitals are orthogonal to eachother.
Just as we did in the previous lecture, we use the Schrödinger equation <span class="arithmatex">\(H |\psi\rangle = E |\psi\rangle\)</span> to set up a system of equations:</p>
<div class="arithmatex">\[
\begin{align}
E \varphi_1 &amp;= E_0 \varphi_1 - t \varphi_2\\
E \varphi_2 &amp;= E_0 \varphi_2 - t \varphi_1 - t \varphi_3\\
E \varphi_3 &amp;= E_0 \varphi_3 -t \varphi_2.
\end{align}
\]</div>
<p>Again, we write this in a matrix form:</p>
<div class="arithmatex">\[
E \begin{pmatrix}
\varphi_1 \\ \varphi_2 \\ \varphi_3
\end{pmatrix} =
\begin{pmatrix}
E_0 &amp; -t &amp; 0 \\
-t &amp; E_0 &amp; -t \\
0 &amp; -t &amp; E_0
\end{pmatrix}
\begin{pmatrix}
\varphi_1 \\ \varphi_2 \\ \varphi_3.
\end{pmatrix}
\]</div>
<h3 id="numerical-test">Numerical test<a class="headerlink" href="#numerical-test" title="Permanent link">¶</a></h3>
<p>Diagonalizing large matrices is unwieldy, but let's try and check it numerically to see if we notice a trend.
Let us first model 3 atoms on a chain.</p>
<p>The eigenfrequencies of the 3 atoms are: <code>[0.0 1.0 1.732050]</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">def</span> <span class="nf">DOS_finite_phonon_chain</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    <span class="n">rhs</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    <span class="n">rhs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="n">rhs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvalsh</span><span class="p">(</span><span class="n">rhs</span><span class="p">))),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"$\omega$"</span><span class="p">)</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Number of eigenfrequencies"</span><span class="p">)</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="n">DOS_finite_phonon_chain</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div>
<p>The eigenenergies of the 3 orbitals are: <code>[-1.41421356 0.0  1.41421356]</code></p>
<p></p><div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">def</span> <span class="nf">DOS_finite_electron_chain</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    <span class="n">rhs</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvalsh</span><span class="p">(</span><span class="n">rhs</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"$E$"</span><span class="p">)</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Number of eigenenergies"</span><span class="p">)</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="n">DOS_finite_electron_chain</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div>
However, 3 atoms are far too few to model an actual solid.
Hence, we need 'many more' atoms.
<h3 id="from-3-atoms-to-300">From 3 atoms to 300<a class="headerlink" href="#from-3-atoms-to-300" title="Permanent link">¶</a></h3>
<p>Phonon modes of the many atom chain are shown below.</p>
<p></p><div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">DOS_finite_phonon_chain</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
</code></pre></div>
We observe that when <span class="arithmatex">\(\omega\)</span> is small, we have a constant DOS.
This is in line with what we saw in the Debye model.
There the DOS of a 1D system was constant!
However, when the frequencies are higher, the DOS is not constant anymore.
<p>A plot of electron energies in the many atom chain is shown below.</p>
<p></p><div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">DOS_finite_electron_chain</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
</code></pre></div>
The numerical results once again agree with the models we developed earlier.
In the Sommerfeld free electron model, the DOS in 1D is proportional to <span class="arithmatex">\(\frac{1}{\sqrt{E}}\)</span>.
The above histogram also reflects this proportionality for small energies <span class="arithmatex">\(E\)</span>.
However, when <span class="arithmatex">\(E\)</span> is higher, we observe a significant deviation from the <span class="arithmatex">\(\frac{1}{\sqrt{E}}\)</span> behavior.
<p>In both cases, we find that our models agree with the numerical results whenever frequencies/energies are small.
When the frequencies/energies are high, we find that there is a significant deviation from the Debye/Sommerfeld models.
The nature of this deviation is the subject of the next lecture!</p>
<hr>
<h2 id="conclusions">Conclusions<a class="headerlink" href="#conclusions" title="Permanent link">¶</a></h2>
<ul>
<li>The DOS of phonons used in the Debye model is justified by modeling the atoms as particles on a chain connected by a spring in the small <span class="arithmatex">\(\omega\)</span> limit.</li>
<li>The DOS of electrons in the Sommerfeld model is justified by modeling electrons as particles that can hop between atoms in the small <span class="arithmatex">\(E\)</span> limit.</li>
</ul>
<h2 id="exercises">Exercises<a class="headerlink" href="#exercises" title="Permanent link">¶</a></h2>
<h3 id="preliminary-provocations">Preliminary provocations<a class="headerlink" href="#preliminary-provocations" title="Permanent link">¶</a></h3>
<ol>
<li>What does the <abbr title="Linear Combination of Atomic Orbitals">LCAO</abbr> matrix in the lecture notes look like if we also consider a next nearest-neighbour hopping <span class="arithmatex">\(-\tilde{t}\)</span>?</li>
<li>What does the <abbr title="Linear Combination of Atomic Orbitals">LCAO</abbr> matrix look like if we consider six atoms instead of three? You may assume that each atom has a single orbital, onsite energy <span class="arithmatex">\(E_0\)</span> and the hopping between neighbouring atoms <span class="arithmatex">\(-t\)</span>.</li>
<li>How do you determine which part of the interatomic potential is attractive and which is repulsive? You may assume that the interatomic potential is only a function of the interatomic distance <span class="arithmatex">\(r\)</span>.</li>
</ol>
<h3 id="exercise-1-linear-triatomic-molecule">Exercise 1: Linear triatomic molecule<a class="headerlink" href="#exercise-1-linear-triatomic-molecule" title="Permanent link">¶</a></h3>
<p>Consider carbon dioxide (C0<span class="arithmatex">\(_2\)</span>) which is a linear triatomic molecule shown below</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/a/af/Carbon-dioxide-3D-vdW.svg" width="50%" alt="carbon dioxide"></p>
<p>??? info "source"</p>
<div class="highlight"><pre><span></span><code>  By Jasek FH. - Own work, [CC BY-SA 4.0](https://creativecommons.org/licenses/by-sa/3.0 "Creative Commons Attribution-Share Alike 3.0"), [Link](https://commons.wikimedia.org/w/index.php?curid=2875238)
</code></pre></div>
<ol>
<li>How many normal modes does this molecule have assuming motion in only 1D?
  How many normal modes does it have if the atoms can move in all three dimensions?</li>
<li>For simplicity, we only consider 1D motion of the atoms.
  Write down Newton's equations of motion for the atoms, you may assume that the spring constant is the same for both bonds.</li>
<li>Consider a <em>symmetric</em> mode, for which the displacements of the oxygen atoms are equal in magnitude and have an opposite direction. Find the eigenfrequency of this mode.</li>
<li>Now consider the antisymmetric mode when both of the oxygen atoms move in phase and have the same displacement.
  Find the ratio between the displacements of the carbon and oxygen atoms. Make sure that the center of mass of the molecule is at rest.</li>
<li>Compute the eigenfrequency of the antisymmetric mode.</li>
</ol>
<details class="hint">
<summary>Hint</summary>
<p>Compare your answers with <a href="https://en.wikipedia.org/wiki/Triatomic_molecule">Wikipedia</a>.</p>
</details>
<hr>
<p>From Diatomic solids</p>
<h3 id="exercise-2-the-peierls-transition">Exercise 2: the Peierls transition<a class="headerlink" href="#exercise-2-the-peierls-transition" title="Permanent link">¶</a></h3>
<p>In the previous lecture, we have derived the electronic band structure of an 1D, equally spaced atomic chain. Such chains, however, are in fact not stable and the equal spacing will be distorted. This is also known as the <a href="https://en.wikipedia.org/wiki/Peierls_transition">Peierls transition</a>.</p>
<p>The spacing of the distorted chain alternates between two different distances and this also causes the hopping energy to alternate between <span class="arithmatex">\(t_1\)</span> and <span class="arithmatex">\(t_2\)</span>. We further set the onsite energies of the atoms to <span class="arithmatex">\(\epsilon\)</span>. The situation is depicted in the figure below.</p>
<p><img alt="" src="figures/peierls_transition.svg"></p>
<p>Due to the alternating hopping energies, we must treat two consecutive atoms as two different orbitals (<span class="arithmatex">\(|n,1⟩\)</span> and <span class="arithmatex">\(|n,2 ⟩\)</span> in the figure) from the same unit cell. The corresponding <abbr title="Linear Combination of Atomic Orbitals">LCAO</abbr> of this chain is given by
<script type="math/tex; mode=display">
\left|\Psi \right\rangle = \sum_n \left(\phi_n \left| n,1 \right\rangle + \psi_n \left| n,2 \right\rangle\right)
</script>
As usual, we assume that all these atomic orbitals are orthogonal to each other.</p>
<ol>
<li>Indicate the length of the unit cell <span class="arithmatex">\(a\)</span> in the figure.</li>
<li>
<p>Using the Schrödinger equation, write the equations of motion of the electrons.</p>
<details class="hint">
<summary>Hint</summary>
<p>To this end, find expressions for <span class="arithmatex">\(E \left&lt; n,1 \vert \Psi \right&gt; = \left&lt; n,1 \right| H \left|\Psi \right&gt;\)</span> and <span class="arithmatex">\(E \left&lt; n,2 \vert \Psi \right&gt; = \left&lt; n,2 \right| H \left|\Psi \right&gt;\)</span>.</p>
</details>
</li>
<li>
<p>Using the trial solutions <span class="arithmatex">\(\phi_n = \phi_0 e^{ikna}\)</span> and <span class="arithmatex">\(\psi_n = \psi_0 e^{ikna}\)</span>, show that the Schödinger equation can be written in matrix form: <span class="arithmatex">\(<span class="arithmatex">\(\begin{pmatrix} \epsilon &amp; t_1 + t_2 e^{-i k a} \\  t_1 + t_2 e^{i k a}  &amp; \epsilon \end{pmatrix} \begin{pmatrix} \phi_0 \\ \psi_0 \end{pmatrix} = E \begin{pmatrix} \phi_0 \\ \psi_0 \end{pmatrix}.\)</span>\)</span></p>
</li>
<li>Derive the dispersion relation of this Hamiltonian. Does it look like the figure of the band structure shown on the <a href="https://en.wikipedia.org/wiki/Peierls_transition#/media/File:Peierls_instability_after.jpg">Wikipedia page</a>? Does it reduce to the 1D, equally spaced atomic chain if <span class="arithmatex">\(t_1 = t_2\)</span>?</li>
<li>Find an expression of the group velocity <span class="arithmatex">\(v(k)\)</span> and effective mass <span class="arithmatex">\(m^*(k)\)</span> of both bands.</li>
<li>Derive an expression for the density of states <span class="arithmatex">\(g(E)\)</span> of the entire band structure and make a plot of it. Does your result makes sense when considering the band structure?</li>
</ol>
<hr>
<h2 id="tight-binding">Tight binding<a class="headerlink" href="#tight-binding" title="Permanent link">¶</a></h2>
<h3 id="group-velocity-effective-mass-density-of-states">Group velocity, effective mass, density of states<a class="headerlink" href="#group-velocity-effective-mass-density-of-states" title="Permanent link">¶</a></h3>
<p><em>(here we only discuss electrons; for phonons everything is the same except for replacing <span class="arithmatex">\(E = \hbar \omega\)</span>)</em></p>
<p>Let us think what happens if we apply an external electric field to the crystal:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.2</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">.2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">1.5</span><span class="p">))</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">.2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.25</span><span class="p">),</span> <span class="s1">'--'</span><span class="p">)</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.7</span><span class="p">,</span> <span class="mf">.5</span><span class="p">)</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"$x$"</span><span class="p">)</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"$U(x)$"</span><span class="p">)</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mf">.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s2">"$0$"</span><span class="p">,</span> <span class="s2">"$a$"</span><span class="p">,</span> <span class="s2">"$2a$"</span><span class="p">])</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="n">draw_classic_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div>
<p>The full Hamiltonian of the system is</p>
<p>
<script type="math/tex; mode=display">
H = \frac{p^2}{2m} + U_\textrm{atomic}(x) + e \mathcal{E} x,
</script>
where <span class="arithmatex">\(U_\textrm{atomic}\)</span> is the potential created by the nuclei, and <span class="arithmatex">\(\mathcal{E}\)</span> the electric field.</p>
<p>A typical electric field is much smaller than the interatomic potential, and therefore we can start by obtaining the dispersion relation <span class="arithmatex">\(E(k)\)</span> without electric field (by applying the <abbr title="Linear Combination of Atomic Orbitals">LCAO</abbr> method), and then solve
<script type="math/tex; mode=display"> H = E(k) + e\mathcal{E}x.</script>
</p>
<p>To derive how particles with an arbitrary dispersion relation move, we recall the <a href="https://en.wikipedia.org/wiki/Hamiltonian_mechanics">Hamilton's equations</a> for particle velocity <span class="arithmatex">\(v\)</span> and force <span class="arithmatex">\(F\)</span>:</p>
<div class="arithmatex">\[\begin{aligned}
v \equiv \frac{dr}{dt} &amp;= \frac{\partial H(p, r)}{\partial p}\\
F \equiv \frac{dp}{dt} &amp;= -\frac{\partial H(p, r)}{\partial r}.
\end{aligned}\]</div>
<p>Substituting <span class="arithmatex">\(p = \hbar k\)</span> into the first equation we arrive to the expression for the electron <strong>group velocity</strong> <span class="arithmatex">\(v \equiv \hbar^{-1}\partial E/\partial k\)</span>.
From the second equation we obtain that the force acting on electron in a band stays <span class="arithmatex">\(-e\mathcal{E}\)</span>, which in turn gives results in the acceleration
<script type="math/tex; mode=display">
\frac{dv}{dt} = \frac{∂v}{∂p}\frac{dp}{dt} = F/m.
</script>
Comparing this expression with <span class="arithmatex">\(dv/dt = F/m\)</span>, we arrive to the <strong>effective mass</strong>:
<script type="math/tex; mode=display">
m^* \equiv \left(\frac{∂v}{∂p}\right)^{-1} = \left(\frac{∂²E}{∂p²}\right)^{-1} = ħ²\left(\frac{∂²E}{∂k²}\right)^{-1}.
</script>
</p>
<p>The group velocity describes how quickly electrons with a certain <span class="arithmatex">\(k\)</span>-vector move, while the effective mass describes how hard they are to accelerate by applying external force.</p>
<p>By using the dispersion relation we derived earlier, we obtain the effective mass like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="n">meff</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="n">color</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">'axes.prop_cycle'</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'color'</span><span class="p">]</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="n">meff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">],</span> <span class="n">meff</span><span class="p">[</span><span class="n">meff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="n">meff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">],</span> <span class="n">meff</span><span class="p">[</span><span class="n">meff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="n">pyplot</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$ka$'</span><span class="p">);</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'$m^*$'</span><span class="p">)</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="n">pyplot</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="p">],</span> <span class="p">[</span><span class="sa">r</span><span class="s1">'$-\pi$'</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\pi$'</span><span class="p">]);</span>
</code></pre></div>
<p>Notice that the effective mass can be negative, which implies the electrons accelerate in the direction opposite to the applied force.</p>
<h3 id="density-of-states">Density of states<a class="headerlink" href="#density-of-states" title="Permanent link">¶</a></h3>
<p>The DOS is the number of states per unit energy. In 1D we have
<span class="arithmatex">\(<span class="arithmatex">\(g(E) = \frac{L}{2\pi}\sum |dk/dE| = \frac{L}{2\pi}\sum |v|^{-1}\)</span>\)</span></p>
<p>The sum goes over all possible values of <span class="arithmatex">\(k\)</span> and spin which have the same energy <span class="arithmatex">\(E\)</span>.
If we are working in two or more dimensions, we must integrate over the values of <span class="arithmatex">\(k\)</span> with the same energy.
Also take note that for energies below <span class="arithmatex">\(E_0 - 2t\)</span> or above <span class="arithmatex">\(E_0 + 2t\)</span>, there are no values of <span class="arithmatex">\(k\)</span> with that energy, so there is nothing to sum over.</p>
<p>Once again, starting from
<script type="math/tex; mode=display"> E = E_0 - 2t \cos(ka), </script>
we get
<script type="math/tex; mode=display">
ka = \pm\arccos[(E - E_0) / 2t],
</script>
and
<script type="math/tex; mode=display">
|v| ^{-1} = \left|\frac{dk}{dE} \right| = \frac{1}{a}\frac{1}{\sqrt{4t^2 - (E - E_0)^2}}.
</script>
You can get to this result immediately if you remember the derivative of arccosine. Otherwise you need to go the long way: compute <span class="arithmatex">\(dE/dk\)</span> as a function of <span class="arithmatex">\(k\)</span>, express <span class="arithmatex">\(k\)</span> through <span class="arithmatex">\(E\)</span> as we did above, and take the inverse.</p>
<p>We now add together the contributions of the positive and the negative momenta as well both spin orientations, and arrive to the density of states
<script type="math/tex; mode=display">
g(E) = \frac{L}{2\pi}\frac{4}{a}\frac{1}{\sqrt{4t^2 - (E - E_0)^2}}.
</script>
A quick check: when the energy is close to the bottom of the band, <span class="arithmatex">\(E = E_0 - 2t + \delta E\)</span>, we get <span class="arithmatex">\(g(E) \propto \delta E^{-1/2}\)</span>, as we expect in 1D.</p>
<p>The process of calculating the DOS at a given energy <span class="arithmatex">\(E\)</span> of a spin-independent Hamiltonian is done systematically with the following steps:</p>
<ol>
<li>At a given energy <span class="arithmatex">\(E\)</span>, determine <em>all</em> of the values of <span class="arithmatex">\(k\)</span> which correspond to that <span class="arithmatex">\(E\)</span> using the dispersion relation.</li>
<li>Compute <span class="arithmatex">\(\rvert dk / dE \rvert\)</span>. Do this either by writing <span class="arithmatex">\(k\)</span> as a (multi-valued) function of <span class="arithmatex">\(E\)</span> and differentiating, or by computing <span class="arithmatex">\((dE / dk)^{-1}\)</span>.</li>
<li>Sum or integrate <span class="arithmatex">\(dk / dE\)</span> over the allowed values of <span class="arithmatex">\(k\)</span> found in 1 and multiply by any degeneracies (spin/polarization).</li>
<li>Multiply by spin degeneracy.</li>
</ol>
<p>If the Hamiltonian depends on spin, then there is no spin degeneracy and the spin number <span class="arithmatex">\(s\)</span> must be treated in the same way as <span class="arithmatex">\(k\)</span>.</p>
<hr></div>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">September 3, 2021</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Content prepared and curated by <a href="mailto:andrew.mcculloch@utas.edu.au">A J McCulloch</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.top", "navigation.sections", "search.highlight", "content.code.annotate", "content.action.view", "announce.dismiss"], "search": "../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="../javascripts/mathjax.js"></script>
        
      
        
          <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
      
    
  </body>
</html>